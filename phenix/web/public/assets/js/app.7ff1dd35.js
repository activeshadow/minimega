(function(e){function t(t){for(var a,n,o=t[0],l=t[1],u=t[2],c=0,d=[];c<o.length;c++)n=o[c],Object.prototype.hasOwnProperty.call(i,n)&&i[n]&&d.push(i[n][0]),i[n]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);p&&p(t);while(d.length)d.shift()();return r.push.apply(r,u||[]),s()}function s(){for(var e,t=0;t<r.length;t++){for(var s=r[t],a=!0,n=1;n<s.length;n++){var o=s[n];0!==i[o]&&(a=!1)}a&&(r.splice(t--,1),e=l(l.s=s[0]))}return e}var a={},n={app:0},i={app:0},r=[];function o(e){return l.p+"assets/js/"+({}[e]||e)+"."+{"chunk-5b06f226":"8c5c0483","chunk-9184ba1e":"9c00be34"}[e]+".js"}function l(t){if(a[t])return a[t].exports;var s=a[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,l),s.l=!0,s.exports}l.e=function(e){var t=[],s={"chunk-5b06f226":1,"chunk-9184ba1e":1};n[e]?t.push(n[e]):0!==n[e]&&s[e]&&t.push(n[e]=new Promise((function(t,s){for(var a="assets/css/"+({}[e]||e)+"."+{"chunk-5b06f226":"d19818c9","chunk-9184ba1e":"a8bdd63b"}[e]+".css",i=l.p+a,r=document.getElementsByTagName("link"),o=0;o<r.length;o++){var u=r[o],c=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(c===a||c===i))return t()}var d=document.getElementsByTagName("style");for(o=0;o<d.length;o++){u=d[o],c=u.getAttribute("data-href");if(c===a||c===i)return t()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onload=t,p.onerror=function(t){var a=t&&t.target&&t.target.src||i,r=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");r.code="CSS_CHUNK_LOAD_FAILED",r.request=a,delete n[e],p.parentNode.removeChild(p),s(r)},p.href=i;var m=document.getElementsByTagName("head")[0];m.appendChild(p)})).then((function(){n[e]=0})));var a=i[e];if(0!==a)if(a)t.push(a[2]);else{var r=new Promise((function(t,s){a=i[e]=[t,s]}));t.push(a[2]=r);var u,c=document.createElement("script");c.charset="utf-8",c.timeout=120,l.nc&&c.setAttribute("nonce",l.nc),c.src=o(e);var d=new Error;u=function(t){c.onerror=c.onload=null,clearTimeout(p);var s=i[e];if(0!==s){if(s){var a=t&&("load"===t.type?"missing":t.type),n=t&&t.target&&t.target.src;d.message="Loading chunk "+e+" failed.\n("+a+": "+n+")",d.name="ChunkLoadError",d.type=a,d.request=n,s[1](d)}i[e]=void 0}};var p=setTimeout((function(){u({type:"timeout",target:c})}),12e4);c.onerror=c.onload=u,document.head.appendChild(c)}return Promise.all(t)},l.m=e,l.c=a,l.d=function(e,t,s){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(l.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)l.d(s,a,function(t){return e[t]}.bind(null,a));return s},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/",l.oe=function(e){throw console.error(e),e};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],c=u.push.bind(u);u.push=t,u=u.slice();for(var d=0;d<u.length;d++)t(u[d]);var p=c;r.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},1:function(e,t){},1801:function(e,t,s){e.exports=s.p+"assets/img/not-running.9f1471e7.png"},"31c2":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[[a("hr"),a("b-field",{attrs:{position:"is-left"}},[a("p",{staticClass:"control"},[null==e.exp?[a("h3",[e._v("All Experiments")])]:[a("h3",[e._v("Experiment: "+e._s(e.exp))])]],2)]),a("br"),a("br"),a("b-field",{attrs:{position:"is-right"}},[a("b-autocomplete",{attrs:{placeholder:"Find a VM",icon:"search",data:e.filteredData},on:{select:function(t){return e.filtered=t}},model:{value:e.searchName,callback:function(t){e.searchName=t},expression:"searchName"}},[a("template",{slot:"empty"},[e._v("No results found")])],2),a("p",{staticClass:"control"},[a("button",{staticClass:"button",staticStyle:{color:"#686868"},on:{click:function(t){e.searchName=""}}},[a("b-icon",{attrs:{icon:"window-close"}})],1)]),e._v("\n         \n      "),a("p",{staticClass:"control buttons"},[a("b-dropdown",{staticClass:"is-right",attrs:{"aria-role":"list"},model:{value:e.exp,callback:function(t){e.exp=t},expression:"exp"}},[a("button",{staticClass:"button is-light",attrs:{slot:"trigger","icon-left":"caret"},slot:"trigger"},[e._v("\n            Select Experiment\n          ")]),a("b-dropdown-item",{on:{click:function(t){e.searchName="",e.exp=null}}},[a("font",{attrs:{color:"#202020"}},[e._v("All Experiments")])],1),e._l(e.experiments,(function(t,s){return a("b-dropdown-item",{key:s,attrs:{value:t},on:{click:function(s){e.searchName="",e.exp=t}}},[a("font",{attrs:{color:"#202020"}},[e._v(e._s(t))])],1)}))],2)],1)],1),e._l(e.chunkedVMs,(function(t){return a("div",[a("div",{staticClass:"tile is-ancestor"},[a("div",{staticClass:"tile is-parent"},[null==e.exp?e._l(t,(function(t){return a("div",{staticClass:"tile is-child box is-4",staticStyle:{"background-color":"grey"}},[a("p",{staticClass:"title",staticStyle:{color:"whitesmoke","font-size":"medium"}},[e._v("\n                "+e._s(e.vmFullName(t))+"\n              ")]),a("figure",{staticClass:"image"},[t.running?[a("a",{attrs:{href:"/api/v1/experiments/"+t.experiment+"/vms/"+t.name+"/vnc?token="+e.$store.state.token,target:"_blank"}},[a("img",{attrs:{src:t.screenshot}})])]:[a("img",{attrs:{src:s("1801")}})]],2)])})):e._l(t,(function(t){return a("div",{staticClass:"tile is-child box is-4",staticStyle:{"background-color":"grey"}},[t.experiment===e.exp?a("p",{staticClass:"title",staticStyle:{color:"whitesmoke","font-size":"medium"}},[e._v("\n                "+e._s(e.vmFullName(t))+"\n              ")]):e._e(),a("figure",{staticClass:"image"},[t.running&&t.experiment===e.exp?[a("a",{attrs:{href:"/api/v1/experiments/"+t.experiment+"/vms/"+t.name+"/vnc?token="+e.$store.state.token,target:"_blank"}},[a("img",{attrs:{src:t.screenshot}})])]:t.experiment===e.exp?[a("img",{attrs:{src:s("1801")}})]:e._e()],2)])}))],2)])])})),a("b-loading",{attrs:{"is-full-page":!0,active:e.isWaiting,"can-cancel":!1},on:{"update:active":function(t){e.isWaiting=t}}})]],2)},n=[],i=(s("6b54"),s("ac6a"),s("5df3"),s("4f7f"),s("75fc")),r=(s("4917"),s("7f7f"),s("3b2b"),{beforeDestroy:function(){clearInterval(this.update)},created:function(){this.updateVms(),this.periodicUpdateVms()},computed:{getVms:function(){var e=this,t=this.vms;this.exp&&(t=t.filter((function(t){return t.experiment===e.exp})));var s=new RegExp(this.searchName,"i"),a=[];for(var n in t){var i=t[n],r=i.name;this.exp||(r=i.experiment+"_"+i.name),r.match(s)&&a.push(i)}return _.sortBy(a,(function(e){return e.experiment.toLowerCase()+"_"+e.name.toLowerCase()}))},experiments:function(){return Object(i["a"])(new Set(this.vms.map((function(e){return e.experiment}))))},chunkedVMs:function(){return _.chunk(this.getVms,3)},filteredData:function(){var e=this,t=[],s=this.getVms;return t=this.exp?s.map((function(e){return e.name})):s.map((function(e){return e.experiment+"_"+e.name})),t.filter((function(t){return t.toString().toLowerCase().indexOf(e.searchName.toLowerCase())>=0}))}},methods:{updateVms:function(){var e=this;this.$http.get("vms?screenshot=500").then((function(t){return t.json().then((function(t){e.vms=t.vms,e.isWaiting=!1}))}),(function(t){e.isWaiting=!1,e.$buefy.toast.open({message:"Getting the VMs failed.",type:"is-danger",duration:4e3})}))},periodicUpdateVms:function(){var e=this;this.update=setInterval((function(){e.updateVms()}),3e4)},vmFullName:function(e){return this.exp?e.name:e.experiment+"_"+e.name}},data:function(){return{exp:null,vms:[],searchName:"",filtered:null,isWaiting:!0}}}),o=r,l=(s("8174"),s("2877")),u=Object(l["a"])(o,a,n,!1,null,"53be3843",null);t["default"]=u.exports},"3d06":function(e,t,s){},"3da6":function(e,t,s){e.exports=s.p+"assets/img/phenix-banner.da47445d.png"},"56d7":function(e,t,s){"use strict";s.r(t);s("a481"),s("cadf"),s("551c"),s("f751"),s("097d");var a=s("2b0e"),n=s("28dd"),i=s("289d"),r=s("b408"),o=s.n(r),l=(s("2ef0"),s("1f54"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("app-header"),s("div",{staticClass:"row"},[s("div",{staticClass:"col-xs-12"},[s("router-view")],1),s("app-footer")],1)],1)}),u=[],c=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e._m(0),s("nav",{staticClass:"navbar is-light",attrs:{role:"navigation","aria-label":"main navigation"}},[s("div",{staticClass:"navbar-menu",attrs:{id:"navbarBasicExample"}},[s("div",{staticClass:"navbar-start"},[e.auth&&e.experimentUser()?s("router-link",{staticClass:"navbar-item",attrs:{to:"/"}},[e._v("Experiments")]):e._e(),e.auth&&e.experimentUser()?s("router-link",{staticClass:"navbar-item",attrs:{to:"/hosts"}},[e._v("Hosts")]):e._e(),e.auth&&e.globalAdmin()?s("router-link",{staticClass:"navbar-item",attrs:{to:"/users"}},[e._v("Users")]):e._e(),e.auth&&e.globalAdmin()?s("router-link",{staticClass:"navbar-item",attrs:{to:"/log"}},[e._v("Log")]):e._e()],1)]),s("div",{staticClass:"navbar-end"},[e.auth?s("div",{staticClass:"navbar-item"},[s("a",{staticClass:"button navbar-item is-light",attrs:{role:"button"},on:{click:e.logout}},[e._v("Logout")])]):e._e()])])])},d=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a",{attrs:{href:"experiments"}},[a("img",{attrs:{src:s("3da6"),width:"240"}})])}],p=(s("6762"),s("2fdb"),{computed:{auth:function(){return this.$store.getters.auth}},methods:{logout:function(){var e=this;this.$http.get("logout").then((function(t){204==t.status&&e.$store.commit("LOGOUT")}))},globalAdmin:function(){return["Global Admin"].includes(this.$store.getters.role)},adminUser:function(){return["Global Admin","Experiment Admin"].includes(this.$store.getters.role)},experimentUser:function(){return["Global Admin","Experiment Admin","Experiment User","Experiment Viewer"].includes(this.$store.getters.role)}}}),m=p,h=s("2877"),f=Object(h["a"])(m,c,d,!1,null,null,null),g=f.exports,b=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},v=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("hr"),s("small",[e._v("Copyright © "),s("b",[e._v("2019 Sandia National Laboratories")]),e._v(". All Rights Reserved.")])])}],y={},w=Object(h["a"])(y,b,v,!1,null,null,null),x=w.exports,k={components:{appHeader:g,appFooter:x},beforeDestroy:function(){this.$disconnect()},created:function(){var e=this,t=localStorage.getItem("user"),s=localStorage.getItem("token"),a=localStorage.getItem("role"),n=localStorage.getItem("auth");if(s&&n){var i={username:t,token:s,role:a};this.$store.commit("LOGIN",{user:i,remember:!0})}this.$store.watch((function(e,t){return t.token}),(function(t,s){t!=s&&(console.log("auth token updated -- initializing websocket"),e.$disconnect(),e.$connect("//"+location.host+"/api/v1/ws?token="+t))}))}},C=k,$=(s("5c0b"),Object(h["a"])(C,l,u,!1,null,null,null)),E=$.exports,M=s("8c4f"),P=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"content"},[s("b-modal",{attrs:{active:e.createModal.active,"on-cancel":e.resetCreateModal,"has-modal-card":""},on:{"update:active":function(t){return e.$set(e.createModal,"active",t)}}},[s("div",{staticClass:"modal-card",staticStyle:{width:"auto"}},[s("header",{staticClass:"modal-card-head"},[s("p",{staticClass:"modal-card-title"},[e._v("Create a New Experiment")])]),s("section",{staticClass:"modal-card-body"},[s("b-field",{attrs:{label:"Experiment Name",type:e.createModal.nameErrType,message:e.createModal.nameErrMsg,autofocus:""}},[s("b-input",{directives:[{name:"focus",rawName:"v-focus"}],attrs:{type:"text"},model:{value:e.createModal.name,callback:function(t){e.$set(e.createModal,"name",t)},expression:"createModal.name"}})],1),s("b-field",{attrs:{label:"Experiment Topology"}},[s("b-select",{attrs:{placeholder:"Select a topology",expanded:""},model:{value:e.createModal.topology,callback:function(t){e.$set(e.createModal,"topology",t)},expression:"createModal.topology"}},e._l(e.topologies,(function(t,a){return s("option",{key:a,domProps:{value:t}},[e._v("\n              "+e._s(t)+"\n            ")])})),0)],1),s("b-tooltip",{attrs:{label:"this list is scrollable and supports multiple selections, \n                          you can select or unselect applications before submitting \n                          the form",type:"is-light is-right",multilined:""}},[s("b-field",{attrs:{label:"Applications"}}),s("b-icon",{staticStyle:{color:"#383838"},attrs:{icon:"question-circle"}})],1),s("b-select",{attrs:{expanded:""},on:{input:function(t){return e.addApp(t)}}},e._l(e.applications,(function(t,a){return s("option",{key:a,domProps:{value:t}},[e._v("\n            "+e._s(t)+"\n          ")])})),0),e._l(e.createModal.apps,(function(t,a){return s("b-tag",{key:a,attrs:{type:"is-light",closable:""},on:{close:function(t){return e.createModal.apps.splice(a,1)}}},[e._v("\n          "+e._s(t)+"\n        ")])})),s("br"),s("br"),s("b-field",{attrs:{label:"VLAN Range"}},[s("b-field",[s("b-input",{attrs:{type:"number",min:"1",max:"4094",placeholder:"minimum",expanded:""},model:{value:e.createModal.vlan_min,callback:function(t){e.$set(e.createModal,"vlan_min",t)},expression:"createModal.vlan_min"}}),s("b-input",{attrs:{type:"number",min:"1",max:"4094",placeholder:"maximum",expanded:""},model:{value:e.createModal.vlan_max,callback:function(t){e.$set(e.createModal,"vlan_max",t)},expression:"createModal.vlan_max"}})],1)],1)],2),s("footer",{staticClass:"modal-card-foot buttons is-right"},[s("button",{staticClass:"button is-light",attrs:{disabled:!e.validate},on:{click:e.create}},[e._v("Create Experiment")])])])]),0==e.experiments.length?[s("section",{staticClass:"hero is-light is-bold is-large"},[s("div",{staticClass:"hero-body"},[s("div",{staticClass:"container",staticStyle:{"text-align":"center"}},[s("h1",{staticClass:"title"},[e._v("\n            There are no experiments!\n          ")]),e.adminUser()?s("b-button",{attrs:{type:"is-success",outlined:""},on:{click:function(t){e.updateTopologies(),e.updateApplications(),e.createModal.active=!0}}},[e._v("Create One Now!")]):e._e()],1)])])]:[s("hr"),s("b-field",{attrs:{position:"is-right"}},[s("b-autocomplete",{attrs:{placeholder:"Find an Experiment",icon:"search",data:e.filteredData},on:{select:function(t){return e.filtered=t}},model:{value:e.searchName,callback:function(t){e.searchName=t},expression:"searchName"}},[s("template",{slot:"empty"},[e._v("\n          No results found\n        ")])],2),s("p",{staticClass:"control"},[s("button",{staticClass:"button",staticStyle:{color:"#686868"},on:{click:function(t){e.searchName=""}}},[s("b-icon",{attrs:{icon:"window-close"}})],1)]),e._v("\n         \n      "),e.globalUser()?s("p",{staticClass:"control"},[s("b-tooltip",{attrs:{label:"create a new experiment",type:"is-light is-left",multilined:""}},[s("button",{staticClass:"button is-light",on:{click:function(t){e.updateTopologies(),e.updateApplications(),e.createModal.active=!0}}},[s("b-icon",{attrs:{icon:"plus"}})],1)])],1):e._e()],1),s("div",[s("b-table",{attrs:{data:e.filteredExperiments,paginated:e.table.isPaginated&&e.paginationNeeded,"per-page":e.table.perPage,"current-page":e.table.currentPage,"pagination-simple":e.table.isPaginationSimple,"pagination-size":e.table.paginationSize,"default-sort-direction":e.table.defaultSortDirection,"default-sort":"name"},on:{"update:currentPage":function(t){return e.$set(e.table,"currentPage",t)},"update:current-page":function(t){return e.$set(e.table,"currentPage",t)}},scopedSlots:e._u([{key:"default",fn:function(t){return[s("b-table-column",{attrs:{field:"name",label:"Name",width:"200",sortable:""}},[e.updating(t.row.status)?[e._v("\n              "+e._s(t.row.name)+"\n            ")]:[s("router-link",{staticClass:"navbar-item",attrs:{to:{name:"experiment",params:{id:t.row.name}}}},[e._v("\n                "+e._s(t.row.name)+"\n              ")])]],2),s("b-table-column",{attrs:{field:"status",label:"Status",width:"100",sortable:"",centered:""}},["starting"==t.row.status?[s("section",[s("b-progress",{attrs:{size:"is-medium",type:"is-warning","show-value":"",value:t.row.percent,format:"percent"}})],1)]:e.adminUser()?[s("span",{staticClass:"tag is-medium",class:e.decorator(t.row.status)},[s("div",{staticClass:"field"},[s("div",{staticClass:"field",on:{click:function(s){t.row.running?e.stop(t.row.name,t.row.status):e.start(t.row.name,t.row.status)}}},[e._v("\n                    "+e._s(t.row.status)+"\n                  ")])])])]:[s("span",{staticClass:"tag is-medium",class:e.decorator(t.row.status)},[e._v("\n                "+e._s(t.row.status)+"\n              ")])]],2),s("b-table-column",{attrs:{field:"topology",label:"Topology",width:"200"}},[e._v("\n            "+e._s(e._f("lowercase")(t.row.topology))+"\n          ")]),s("b-table-column",{attrs:{field:"apps",label:"Applications",width:"200"}},[e._v("\n            "+e._s(e._f("lowercase")(e._f("stringify")(t.row.apps)))+"\n          ")]),s("b-table-column",{attrs:{field:"start_time",label:"Start Time",width:"250",sortable:""}},[e._v("\n            "+e._s(t.row.start_time)+"\n          ")]),s("b-table-column",{attrs:{field:"vm_count",label:"# of VMs",width:"100",centered:"",sortable:""}},[e._v("\n            "+e._s(t.row.vm_count)+"\n          ")]),s("b-table-column",{attrs:{field:"vlan_range",label:"VLAN Range",width:"100",centered:""}},[e._v("\n            "+e._s(t.row.vlan_min)+" - "+e._s(t.row.vlan_max)+"\n          ")]),s("b-table-column",{attrs:{field:"vlan_count",label:"Total VLANs",width:"100",centered:""}},[e._v("\n            "+e._s(t.row.vlan_count)+"\n          ")]),e.globalUser()?s("b-table-column",{attrs:{label:"Delete",width:"50",centered:""}},[s("button",{staticClass:"button is-light is-small",attrs:{disabled:e.updating(t.row.status)},on:{click:function(s){return e.del(t.row.name,t.row.running)}}},[s("b-icon",{attrs:{icon:"trash"}})],1)]):e._e()]}}])},[s("template",{slot:"empty"},[s("section",{staticClass:"section"},[s("div",{staticClass:"content has-text-white has-text-centered"},[e._v("\n              Your search turned up empty!\n            ")])])])],2),s("br"),e.paginationNeeded?s("b-field",{attrs:{grouped:"",position:"is-right"}},[s("div",{staticClass:"control is-flex"},[s("b-switch",{attrs:{size:"is-small",type:"is-light"},model:{value:e.table.isPaginated,callback:function(t){e.$set(e.table,"isPaginated",t)},expression:"table.isPaginated"}},[e._v("Pagenate")])],1)]):e._e()],1)],s("b-loading",{attrs:{"is-full-page":!0,active:e.isWaiting,"can-cancel":!1},on:{"update:active":function(t){e.isWaiting=t}}})],2)},S=[],N=(s("4f7f"),s("5df3"),s("1c4c"),s("75fc")),U=(s("28a5"),s("ac6a"),s("6b54"),s("7f7f"),s("4917"),s("3b2b"),s("96cf"),s("3b8d")),A={beforeDestroy:function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$options.sockets.onmessage=null;case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),created:function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$options.sockets.onmessage=this.handler,this.updateExperiments();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),computed:{filteredExperiments:function(){var e=this.experiments,t=new RegExp(this.searchName,"i"),s=[];for(var a in e){var n=e[a];n.name.match(t)&&(n.start_time=""==n.start_time?"N/A":n.start_time,s.push(n))}return s},filteredData:function(){var e=this,t=this.experiments.map((function(e){return e.name}));return t.filter((function(t){return t.toString().toLowerCase().indexOf(e.searchName.toLowerCase())>=0}))},paginationNeeded:function(){var e=this.experiments;return!(e.length<=10)},validate:function(){if(!this.createModal.name)return!1;for(var e=0;e<this.experiments.length;e++)if(this.experiments[e].name==this.createModal.name)return this.createModal.nameErrType="is-danger",this.createModal.nameErrMsg="experiment with this name already exists",!1;return/\s/.test(this.createModal.name)?(this.createModal.nameErrType="is-danger",this.createModal.nameErrMsg="experiment names cannot have a space",!1):(/[A-Z]/.test(this.createModal.name)?(this.createModal.nameErrType="is-danger",this.createModal.nameErrMsg="experiment names cannot have an upper case letter"):"create"==this.createModal.name?(this.createModal.nameErrType="is-danger",this.createModal.nameErrMsg="experiment names cannot be create!"):(this.createModal.nameErrType=null,this.createModal.nameErrMsg=null),!!this.createModal.topology&&(!(this.createModal.vlan_max<this.createModal.vlan_min)&&(!(this.createModal.vlan_min<0)&&(!(this.createModal.vlan_min>4094)&&(!(this.createModal.vlan_max<0)&&!(this.createModal.vlan_max>4094))))))}},methods:{handler:function(e){var t=this;e.data.split(/\r?\n/).forEach((function(e){var s=JSON.parse(e);t.handle(s)}))},handle:function(e){if("experiment"==e.resource.type){var t=this.experiments;switch(e.resource.action){case"create":e.result.status="stopped",t.push(e.result),this.experiments=Object(N["a"])(t),this.$buefy.toast.open({message:"The "+e.resource.name+" experiment has been created.",type:"is-success",duration:4e3});break;case"delete":for(var s=0;s<t.length;s++)if(t[s].name==e.resource.name){t.splice(s,1);break}this.experiments=Object(N["a"])(t),this.$buefy.toast.open({message:"The "+e.resource.name+" experiment has been deleted.",type:"is-success",duration:4e3});break;case"start":for(var a=0;a<t.length;a++)if(t[a].name==e.resource.name){t[a]=e.result;break}this.experiments=Object(N["a"])(t),this.$buefy.toast.open({message:"The "+e.resource.name+" experiment has been started.",type:"is-success",duration:4e3});break;case"stop":for(var n=0;n<t.length;n++)if(t[n].name==e.resource.name){t[n]=e.result,t[n].status="stopped";break}this.experiments=Object(N["a"])(t),this.$buefy.toast.open({message:"The "+e.resource.name+" experiment has been stopped.",type:"is-success",duration:4e3});break;case"starting":case"stopping":for(var i=0;i<t.length;i++)if(t[i].name==e.resource.name){t[i].status=e.resource.action,t[i].percent=0;break}this.experiments=Object(N["a"])(t),this.$buefy.toast.open({message:"The "+e.resource.name+" experiment is being updated.",type:"is-warning"});break;case"progress":for(var r=(100*e.result.percent).toFixed(0),o=0;o<t.length;o++)if(t[o].name==e.resource.name){t[o].percent=parseInt(r);break}this.experiments=Object(N["a"])(t);break}}},updateExperiments:function(){var e=this;this.$http.get("experiments").then((function(t){t.json().then((function(t){e.experiments=t.experiments,e.isWaiting=!1}))}),(function(t){e.isWaiting=!1,e.$buefy.toast.open({message:"Getting the experiments failed.",type:"is-danger",duration:4e3})}))},updateTopologies:function(){var e=this;this.$http.get("topologies").then((function(t){t.json().then((function(t){e.topologies=t.topologies,e.isWaiting=!1}))}),(function(t){e.isWaiting=!1,e.$buefy.toast.open({message:"Getting the topologies failed.",type:"is-danger",duration:4e3})}))},updateApplications:function(){var e=this;this.$http.get("applications").then((function(t){t.json().then((function(t){e.applications=t.applications,e.isWaiting=!1}))}),(function(t){e.isWaiting=!1,e.$buefy.toast.open({message:"Getting the applications failed.",type:"is-danger",duration:4e3})}))},globalUser:function(){return["Global Admin"].includes(this.$store.getters.role)},adminUser:function(){return["Global Admin","Experiment Admin"].includes(this.$store.getters.role)},experimentUser:function(){return["Global Admin","Experiment Admin","Experiment User"].includes(this.$store.getters.role)},update:function(e){this.isMenuActive=!0},updating:function(e){return"starting"===e||"stopping"===e},decorator:function(e){switch(e){case"started":return"is-success";case"starting":case"stopping":return"is-warning";case"stopped":return"is-danger"}},start:function(e,t){var s=this;"starting"!=t&&"stopping"!=t?this.$buefy.dialog.confirm({title:"Start the Experiment",message:"This will start the "+e+" experiment.",cancelText:"Cancel",confirmText:"Start",type:"is-success",hasIcon:!0,onConfirm:function(){var t=Object(U["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,s.$http.post("experiments/"+e+"/start");case 3:console.log("experiment started"),t.next=10;break;case 6:t.prev=6,t.t0=t["catch"](0),s.$buefy.toast.open({message:"Starting the "+e+" experiment failed with "+t.t0.status+" status.",type:"is-danger",duration:4e3}),s.isWaiting=!1;case 10:case"end":return t.stop()}}),t,null,[[0,6]])})));function a(){return t.apply(this,arguments)}return a}()}):this.$buefy.toast.open({message:"The "+e+" experiment is currently "+t+". You cannot make any changes at this time.",type:"is-warning"})},stop:function(e,t){var s=this;"starting"!=t&&"stopping"!=t?this.$buefy.dialog.confirm({title:"Stop the Experiment",message:"This will stop the "+e+" experiment.",cancelText:"Cancel",confirmText:"Stop",type:"is-danger",hasIcon:!0,onConfirm:function(){s.$http.post("experiments/"+e+"/stop").then((function(e){console.log("experiment stopped")}),(function(t){s.$buefy.toast.open({message:"Stopping the "+e+" experiment failed with "+t.status+" status.",type:"is-danger",duration:4e3}),s.isWaiting=!1}))}}):this.$buefy.toast.open({message:"The "+e+" experiment is currently "+t+". You cannot make any changes at this time.",type:"is-warning"})},del:function(e,t){var s=this;t?this.$buefy.toast.open({message:"The "+e+" experiment is running; you must stop it before deleting it.",type:"is-warning",duration:4e3}):this.$buefy.dialog.confirm({title:"Delete the Experiment",message:"This will DELETE the "+e+" experiment. Are you sure you want to do this?",cancelText:"Cancel",confirmText:"Delete",type:"is-danger",hasIcon:!0,onConfirm:function(){s.isWaiting=!0,s.$http.delete("experiments/"+e).then((function(t){if(204==t.status){for(var a=s.experiments,n=0;n<a.length;n++)if(a[n].name==e){a.splice(n,1);break}s.experiments=Object(N["a"])(a)}s.isWaiting=!1}),(function(t){s.$buefy.toast.open({message:"Deleting the "+e+" experiment failed with "+t.status+" status.",type:"is-danger",duration:4e3}),s.isWaiting=!1}))}})},create:function(){var e=this,t={name:this.createModal.name,topology:this.createModal.topology,apps:this.createModal.apps,vlan_min:+this.createModal.vlan_min,vlan_max:+this.createModal.vlan_max},s=Array.from(new Set(t.apps));return t.apps=s,this.createModal.name?this.createModal.topology?(this.isWaiting=!0,this.$http.post("experiments",t,{timeout:0}).then((function(t){e.isWaiting=!1}),(function(s){e.$buefy.toast.open({message:"Creating the "+t.name+" experiment failed with "+s.status+" status.",type:"is-danger",duration:4e3}),e.isWaiting=!1})),this.createModal.active=!1,void this.resetCreateModal()):(this.$buefy.toast.open({message:"You must select an experiment topology.",type:"is-warning",duration:4e3}),{}):(this.$buefy.toast.open({message:"You must include a name for the experiment.",type:"is-warning",duration:4e3}),{})},addApp:function(e){this.createModal.apps.push(e),this.createModal.apps=_.uniq(this.createModal.apps)},resetCreateModal:function(){this.createModal={active:!1,name:null,nameErrType:null,nameErrMsg:null,topology:null,apps:[],vlan_min:null,vlan_max:null}}},directives:{focus:{inserted:function(e){"INPUT"==e.tagName?e.focus():e.querySelector("input").focus()}}},data:function(){return{table:{isPaginated:!0,perPage:10,currentPage:1,isPaginationSimple:!0,paginationSize:"is-small",defaultSortDirection:"asc"},createModal:{active:!1,name:null,nameErrType:null,nameErrMsg:null,topology:null,apps:[],vlan_min:null,vlan_max:null},experiments:[],topologies:[],applications:[],searchName:"",filtered:null,isMenuActive:!1,action:null,rowName:null,isWaiting:!0}}},O=A,T=(s("77a4"),Object(h["a"])(O,P,S,!1,null,"45304e9c",null)),j=T.exports,L=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(e.component,{tag:"component"})},W=[],D={components:{running:function(){return s.e("chunk-9184ba1e").then(s.bind(null,"106d"))},stopped:function(){return s.e("chunk-5b06f226").then(s.bind(null,"6f55"))},vmtiles:function(){return Promise.resolve().then(s.bind(null,"31c2"))}},beforeRouteEnter:function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(t,s,n){var i,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a["a"].http.get("experiments/"+t.params.id);case 3:return i=e.sent,e.next=6,i.json();case 6:r=e.sent,n((function(e){return e.running=r.running})),e.next=15;break;case 10:e.prev=10,e.t0=e["catch"](0),console.log(e.t0),a["a"].toast.open({message:"Getting the "+t.params.id+" experiment failed.",type:"is-danger",duration:4e3}),n();case 15:case"end":return e.stop()}}),e,null,[[0,10]])})));function t(t,s,a){return e.apply(this,arguments)}return t}(),computed:{component:function(){if(null!=this.running)return 1==this.running?"VM Viewer"===this.$store.getters.role?"vmtiles":"running":"stopped"}},data:function(){return{running:null}}},R=D,I=Object(h["a"])(R,L,W,!1,null,null,null),G=I.exports,V=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"content"},[s("hr"),s("b-table",{attrs:{data:e.hosts,paginated:e.table.isPaginated&&e.paginationNeeded,"per-page":e.table.perPage,"current-page":e.table.currentPage,"pagination-simple":e.table.isPaginationSimple,"pagination-size":e.table.paginationSize,"default-sort-direction":e.table.defaultSortDirection,"default-sort":"name"},on:{"update:currentPage":function(t){return e.$set(e.table,"currentPage",t)},"update:current-page":function(t){return e.$set(e.table,"currentPage",t)}},scopedSlots:e._u([{key:"default",fn:function(t){return[s("b-table-column",{attrs:{field:"name",label:"Name",width:"150",sortable:""}},[e._v("\n          "+e._s(t.row.name)+"\n        ")]),s("b-table-column",{attrs:{field:"cpus",label:"CPUs",width:"50",sortable:"",centered:""}},[e._v("\n          "+e._s(t.row.cpus)+"\n        ")]),s("b-table-column",{attrs:{field:"load",label:"Load",width:"250",centered:""}},[s("span",{staticClass:"tag",class:e.decorator(t.row.load[0],t.row.cpus)},[e._v("\n            "+e._s(t.row.load[0])+"\n          ")]),e._v("\n          --\n          "),s("span",{staticClass:"tag",class:e.decorator(t.row.load[1],t.row.cpus)},[e._v("\n            "+e._s(t.row.load[1])+"\n          ")]),e._v("\n          --\n          "),s("span",{staticClass:"tag",class:e.decorator(t.row.load[2],t.row.cpus)},[e._v("\n            "+e._s(t.row.load[2])+"\n          ")])]),s("b-table-column",{attrs:{field:"mem_used",label:"RAM Used",width:"100",centered:""}},[s("span",{staticClass:"tag",class:e.decorator(t.row.memused,t.row.memtotal)},[e._v("\n            "+e._s(e._f("ram")(t.row.memused))+"\n          ")])]),s("b-table-column",{attrs:{field:"mem_total",label:"RAM Total",width:"100",centered:""}},[e._v("\n          "+e._s(e._f("ram")(t.row.memtotal))+"\n        ")]),s("b-table-column",{attrs:{field:"bandwidth",label:"Bandwidth (MB/sec)",width:"200",centered:""}},[e._v("\n          "+e._s(t.row.bandwidth)+"\n        ")]),s("b-table-column",{attrs:{field:"no_vms",label:"# of VMs",width:"100",sortable:"",centered:""}},[e._v("\n          "+e._s(t.row.vms)+"\n        ")]),s("b-table-column",{attrs:{field:"uptime",label:"Uptime",width:"165"}},[e._v("\n          "+e._s(e._f("uptime")(t.row.uptime))+"\n        ")])]}}])}),s("br"),e.paginationNeeded?s("b-field",{attrs:{grouped:"",position:"is-right"}},[s("div",{staticClass:"control is-flex"},[s("b-switch",{attrs:{size:"is-small",type:"is-light"},model:{value:e.table.isPaginated,callback:function(t){e.$set(e.table,"isPaginated",t)},expression:"table.isPaginated"}},[e._v("Pagenate")])],1)]):e._e(),s("b-loading",{attrs:{"is-full-page":!0,active:e.isWaiting,"can-cancel":!1},on:{"update:active":function(t){e.isWaiting=t}}})],1)},z=[],Y={beforeDestroy:function(){clearInterval(this.update)},created:function(){this.updateHosts(),this.periodicUpdateHosts()},methods:{updateHosts:function(){var e=this;this.$http.get("hosts").then((function(t){t.json().then((function(t){0==t.hosts.length?e.isWaiting=!0:(e.hosts=t.hosts,e.isWaiting=!1)}))}),(function(t){console.log("Getting the hosts failed with "+t+" response."),e.isWaiting=!1,e.$buefy.toast.open({message:"Getting the hosts failed.",type:"is-danger",duration:4e3})}))},periodicUpdateHosts:function(){var e=this;this.update=setInterval((function(){e.updateHosts()}),1e4)},decorator:function(e,t){var s=e/t;return s<.65?"is-success":s>=.65&&s<.85?"is-warning":"is-danger"}},computed:{paginationNeeded:function(){return!(this.hosts.length<=10)}},data:function(){return{table:{isPaginated:!0,perPage:10,currentPage:1,isPaginationSimple:!0,paginationSize:"is-small",defaultSortDirection:"asc"},hosts:[],isWaiting:!0}}},F=Y,B=Object(h["a"])(F,V,z,!1,null,null,null),H=B.exports,q=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"signin"}},[s("b-modal",{attrs:{active:e.signUpModal,"has-modal-card":""},on:{"update:active":function(t){e.signUpModal=t}}},[s("div",{staticClass:"modal-card",staticStyle:{width:"auto"}},[s("header",{staticClass:"modal-card-head"},[s("p",{staticClass:"modal-card-title"},[e._v("Create a New Account")])]),s("section",{staticClass:"modal-card-body"},[s("b-field",{attrs:{label:"User Name",type:{"is-danger":e.userExists},message:{"User already exists":e.userExists}}},[s("b-input",{attrs:{type:"text",minlength:"4",maxlength:"32",autofocus:""},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1),s("b-field",{attrs:{label:"First Name"}},[s("b-input",{attrs:{type:"text"},model:{value:e.first_name,callback:function(t){e.first_name=t},expression:"first_name"}})],1),s("b-field",{attrs:{label:"Last Name"}},[s("b-input",{attrs:{type:"text"},model:{value:e.last_name,callback:function(t){e.last_name=t},expression:"last_name"}})],1),s("b-field",{attrs:{label:"Password"}},[s("b-input",{attrs:{type:"password",minlength:"8",maxlength:"32"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),s("b-field",{attrs:{label:"Confirm Password"}},[s("b-input",{attrs:{type:"password",minlength:"8",maxlength:"32"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.create(t)}},model:{value:e.confirmPassword,callback:function(t){e.confirmPassword=t},expression:"confirmPassword"}})],1)],1),s("footer",{staticClass:"modal-card-foot buttons is-right"},[s("button",{staticClass:"button is-light",on:{click:e.create}},[e._v("Create User")])])])]),s("div",{staticClass:"signin-form"},[s("b-field",{attrs:{label:"Username"}},[s("b-input",{attrs:{type:"text",autofocus:""},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1),s("b-field",{attrs:{label:"Password"}},[s("b-input",{attrs:{type:"password"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSubmit(t)}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),s("b-checkbox",{attrs:{type:"is-light",size:"is-small","native-value":"false"},model:{value:e.rememberMe,callback:function(t){e.rememberMe=t},expression:"rememberMe"}},[e._v("Remember me")]),s("br"),s("button",{staticClass:"button is-light",on:{click:e.onSubmit}},[e._v("Submit")]),s("button",{staticClass:"button is-pulled-right is-small is-text",on:{click:function(t){e.signUpModal=!0}}},[e._v("Create Account")])],1)],1)},J=[],K={methods:{onSubmit:function(){var e=this;return this.username?this.password?void this.$http.get("login?user="+this.username+"&pass="+this.password).then((function(t){t.json().then((function(t){e.$store.commit("LOGIN",{user:t,remember:e.rememberMe})}))}),(function(t){401==t.status?(e.$buefy.toast.open({message:"The email and/or password is incorrect",type:"is-warning",duration:4e3}),e.username=null,e.password=null):0==t.status?(e.$buefy.toast.open({message:"The data server is not available.",type:"is-danger",duration:6e3}),e.username=null,e.password=null):(e.$buefy.toast.open({message:"Getting the user information failed.",type:"is-danger",duration:4e3}),e.username=null,e.password=null)})):(this.$buefy.toast.open({message:"You must include a password",type:"is-warning",duration:4e3}),{}):(this.$buefy.toast.open({message:"You must include an email address",type:"is-warning",duration:4e3}),{})},create:function(){var e=this;return this.username?this.first_name?this.last_name?this.password?this.confirmPassword?this.password!=this.confirmPassword?(this.$buefy.toast.open({message:"Your passwords do not match",type:"is-warning",duration:4e3}),{}):(this.$http.post("signup",{username:this.username,password:this.password,first_name:this.first_name,last_name:this.last_name}).then((function(t){return t.json().then((function(t){e.$store.commit("SIGN_UP",t)}))}),(function(t){e.$buefy.toast.open({message:"Posting the new user "+e.username+" information failed.",type:"is-danger",duration:4e3}),e.username=null,e.password=null})),void(this.signUpModal=!1)):(this.$buefy.toast.open({message:"You must include a password confirmation",type:"is-warning",duration:4e3}),{}):(this.$buefy.toast.open({message:"You must include a password",type:"is-warning",duration:4e3}),{}):(this.$buefy.toast.open({message:"You must include a last name",type:"is-warning",duration:4e3}),{}):(this.$buefy.toast.open({message:"You must include a first name",type:"is-warning",duration:4e3}),{}):(this.$buefy.toast.open({message:"You must include an username",type:"is-warning",duration:4e3}),{})}},data:function(){return{signUpModal:!1,username:null,password:null,confirmPassword:null,first_name:null,last_name:null,rememberMe:!1,userExists:!1}}},Z=K,Q=(s("5ea9"),Object(h["a"])(Z,q,J,!1,null,"4e710108",null)),X=Q.exports,ee=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"content"},[s("b-modal",{attrs:{active:e.isCreateActive,"on-cancel":e.resetLocalUser,"has-modal-card":""},on:{"update:active":function(t){e.isCreateActive=t}}},[s("div",{staticClass:"modal-card",staticStyle:{width:"25em"}},[s("header",{staticClass:"modal-card-head"},[s("p",{staticClass:"modal-card-title"},[e._v("Create a New User")])]),s("section",{staticClass:"modal-card-body"},[s("b-field",{attrs:{label:"User Name",type:{"is-danger":e.userExists},message:{"User already exists":e.userExists}}},[s("b-input",{attrs:{type:"text",minlength:"4",maxlength:"32",autofocus:""},model:{value:e.user.username,callback:function(t){e.$set(e.user,"username",t)},expression:"user.username"}})],1),s("b-field",{attrs:{label:"First Name"}},[s("b-input",{attrs:{type:"text"},model:{value:e.user.first_name,callback:function(t){e.$set(e.user,"first_name",t)},expression:"user.first_name"}})],1),s("b-field",{attrs:{label:"Last Name"}},[s("b-input",{attrs:{type:"text"},model:{value:e.user.last_name,callback:function(t){e.$set(e.user,"last_name",t)},expression:"user.last_name"}})],1),s("b-field",{attrs:{label:"Password"}},[s("b-input",{attrs:{type:"password",minlength:"8",maxlength:"32"},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}})],1),s("b-field",{attrs:{label:"Confirm Password"}},[s("b-input",{attrs:{type:"password",minlength:"8",maxlength:"32"},model:{value:e.user.confirmPassword,callback:function(t){e.$set(e.user,"confirmPassword",t)},expression:"user.confirmPassword"}})],1),s("b-field",{attrs:{label:"Role"}},[s("b-select",{attrs:{expanded:""},model:{value:e.user.role_name,callback:function(t){e.$set(e.user,"role_name",t)},expression:"user.role_name"}},e._l(e.roles,(function(t){return s("option",[e._v("\n              "+e._s(t)+"\n            ")])})),0)],1),s("b-tooltip",{attrs:{label:"resource names can include wildcards for broad  \n                assignment (ex. *inv*); they can also include `!` to not   \n                allow access to a resource (ex. !*inv*)",type:"is-light is-right",multilined:""}},[s("b-field",{attrs:{label:"Resource Name(s)"}}),s("b-icon",{staticStyle:{color:"#383838"},attrs:{icon:"question-circle"}})],1),s("b-input",{attrs:{type:"text"},model:{value:e.user.resource_names,callback:function(t){e.$set(e.user,"resource_names",t)},expression:"user.resource_names"}})],1),s("footer",{staticClass:"modal-card-foot buttons is-right"},[s("button",{staticClass:"button is-light",on:{click:e.createUser}},[e._v("Create User")])])])]),s("b-modal",{attrs:{active:e.isEditActive,"on-cancel":e.resetLocalUser,"has-modal-card":""},on:{"update:active":function(t){e.isEditActive=t}}},[s("div",{staticClass:"modal-card",staticStyle:{width:"25em"}},[s("header",{staticClass:"modal-card-head"},[s("p",{staticClass:"modal-card-title"},[e._v("User "+e._s(e.user.username))])]),s("section",{staticClass:"modal-card-body"},[s("b-field",{attrs:{label:"First Name"}},[s("b-input",{attrs:{type:"text",autofocus:""},model:{value:e.user.first_name,callback:function(t){e.$set(e.user,"first_name",t)},expression:"user.first_name"}})],1),s("b-field",{attrs:{label:"Last Name"}},[s("b-input",{attrs:{type:"text"},model:{value:e.user.last_name,callback:function(t){e.$set(e.user,"last_name",t)},expression:"user.last_name"}})],1),s("b-field",{attrs:{label:"Role"}},[s("b-select",{attrs:{expanded:""},model:{value:e.user.role_name,callback:function(t){e.$set(e.user,"role_name",t)},expression:"user.role_name"}},e._l(e.roles,(function(t){return s("option",[e._v("\n              "+e._s(t)+"\n            ")])})),0)],1),s("b-field",{attrs:{label:"Resource Name(s)"}},[s("b-input",{attrs:{type:"text"},model:{value:e.user.resource_names,callback:function(t){e.$set(e.user,"resource_names",t)},expression:"user.resource_names"}})],1)],1),s("footer",{staticClass:"modal-card-foot buttons is-right"},[s("button",{staticClass:"button is-light",on:{click:e.updateUser}},[e._v("Update User")])])])]),[s("hr"),s("b-field",{attrs:{grouped:"",position:"is-right"}},[e.adminUser()?s("p",{staticClass:"control"},[s("b-tooltip",{attrs:{label:"create a new user",type:"is-light is-left"}},[s("button",{staticClass:"button is-light",on:{click:function(t){e.isCreateActive=!0}}},[s("b-icon",{attrs:{icon:"plus"}})],1)])],1):e._e()]),s("div",[s("b-table",{attrs:{data:e.users,paginated:e.table.isPaginated&&e.paginationNeeded,"per-page":e.table.perPage,"current-page":e.table.currentPage,"pagination-simple":e.table.isPaginationSimple,"pagination-size":e.table.paginationSize,"default-sort-direction":e.table.defaultSortDirection,"default-sort":"username"},on:{"update:currentPage":function(t){return e.$set(e.table,"currentPage",t)},"update:current-page":function(t){return e.$set(e.table,"currentPage",t)}},scopedSlots:e._u([{key:"default",fn:function(t){return[s("b-table-column",{attrs:{field:"username",label:"User",sortable:""}},[e.adminUser()?[s("b-tooltip",{attrs:{label:"change user settings",type:"is-dark"}},[s("div",{staticClass:"field"},[s("div",{on:{click:function(s){return e.editUser(t.row.username)}}},[e._v("\n                    "+e._s(t.row.username)+"\n                  ")])])])]:[e._v("\n              "+e._s(t.row.username)+"\n            ")]],2),s("b-table-column",{attrs:{field:"first_name",label:"First Name"}},[e._v("\n            "+e._s(t.row.first_name)+"\n          ")]),s("b-table-column",{attrs:{field:"last_name",label:"Last Name",sortable:""}},[e._v("\n            "+e._s(t.row.last_name)+"\n          ")]),s("b-table-column",{attrs:{field:"role",label:"Role",sortable:""}},[e._v("\n            "+e._s(t.row.role?t.row.role.name:"Not yet assigned")+"\n          ")]),e.adminUser()?s("b-table-column",{attrs:{label:"Delete",width:"50",centered:""}},[s("button",{staticClass:"button is-light is-small",on:{click:function(s){return e.deleteUser(t.row.username)}}},[s("b-icon",{attrs:{icon:"trash"}})],1)]):e._e()]}}])}),e.paginationNeeded?s("b-field",{attrs:{grouped:"",position:"is-right"}},[s("div",{staticClass:"control is-flex"},[s("b-switch",{attrs:{size:"is-small",type:"is-light"},model:{value:e.table.isPaginated,callback:function(t){e.$set(e.table,"isPaginated",t)},expression:"table.isPaginated"}},[e._v("Pagenate")])],1)]):e._e()],1)],s("b-loading",{attrs:{"is-full-page":!0,active:e.isWaiting,"can-cancel":!1},on:{"update:active":function(t){e.isWaiting=t}}})],2)},te=[],se={beforeDestroy:function(){this.$options.sockets.onmessage=null},created:function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$options.sockets.onmessage=this.handler,this.updateUsers();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),computed:{paginationNeeded:function(){return!(this.users.length<=10)}},methods:{handler:function(e){var t=this;e.data.split(/\r?\n/).forEach((function(e){var s=JSON.parse(e);t.handle(s)}))},handle:function(e){if("user"==e.resource.type){var t=this.users;switch(e.resource.action){case"create":var s=e.result;s.role.resource_names=s.role.resource_names.join(" "),t.push(s),this.users=Object(N["a"])(t),this.$buefy.toast.open({message:"The "+e.resource.name+" user was created.",type:"is-success"});break;case"update":for(var a=0;a<t.length;a++)if(t[a].username==e.resource.name){var n=e.result;n.role.resource_names=n.role.resource_names.join(" "),t[a]=n;break}this.users=Object(N["a"])(t),this.$buefy.toast.open({message:"The "+e.resource.name+" user was updated.",type:"is-success"});break;case"delete":for(var i=0;i<t.length;i++)if(t[i].username==e.resource.name){t.splice(i,1);break}this.users=Object(N["a"])(t),this.$buefy.toast.open({message:"The "+e.resource.name+" user was deleted.",type:"is-success"});break}}},updateUsers:function(){var e=this;this.$http.get("users").then((function(t){t.json().then((function(t){e.users=t.users,e.isWaiting=!1}))}),(function(t){e.$buefy.toast.open({message:"Getting the users failed.",type:"is-danger",duration:4e3}),e.isWaiting=!1}))},adminUser:function(){return["Global Admin","Experiment Admin"].includes(this.$store.getters.role)},experimentUser:function(){return["Global Admin","Experiment Admin","Experiment User"].includes(this.$store.getters.role)},createUser:function(){for(var e=this,t=0;t<this.users.length;t++)if(this.users[t].username==this.user.username)return void(this.userExists=!0);if(this.user.username)if(this.user.first_name)if(this.user.last_name)if(this.user.password)if(this.user.confirmPassword)if(this.user.password==this.user.confirmPassword)if(delete this.user.confirmPassword,this.user.role_name){this.user.resource_names&&(this.user.resource_names=this.user.resource_names.split(" ")),this.isWaiting=!0;var s=this.user.username;this.$http.post("users",this.user).then((function(t){e.isWaiting=!1}),(function(t){e.$buefy.toast.open({message:"Creating the user "+s+" failed with "+t.status+" status.",type:"is-danger",duration:4e3}),e.isWaiting=!1})),this.resetLocalUser(),this.isCreateActive=!1}else this.$buefy.toast.open({message:"You must select a role",type:"is-warning",duration:4e3});else this.$buefy.toast.open({message:"Your passwords do not match",type:"is-warning",duration:4e3});else this.$buefy.toast.open({message:"You must include a password confirmation",type:"is-warning",duration:4e3});else this.$buefy.toast.open({message:"You must include a password",type:"is-warning",duration:4e3});else this.$buefy.toast.open({message:"You must include a last name",type:"is-warning",duration:4e3});else this.$buefy.toast.open({message:"You must include a first name",type:"is-warning",duration:4e3});else this.$buefy.toast.open({message:"You must include an username",type:"is-warning",duration:4e3})},editUser:function(e){for(var t=0;t<this.users.length;t++)if(this.users[t].username==e){this.user=this.users[t];break}if(this.user.role){this.user.role_name=this.user.role.name;for(var s=[],a=0;a<this.user.role.policies.length;a++){var n=this.user.role.policies[a],i=["disks","hosts","users"];if(!i.includes(n.resources[0])&&n.resource_names)for(var r=0;r<n.resource_names.length;r++)s.push(n.resource_names[r])}this.user.resource_names=_.uniq(s).join(" ")}this.isEditActive=!0},updateUser:function(){var e=this;if(this.$store.getters.username==this.user.username&&this.$store.getters.role!=this.user.role_name)return this.$buefy.toast.open({message:"You cannot change the role of the user you are currently logged in as.",type:"is-danger",duration:5e3}),this.resetLocalUser(),this.isWaiting=!1,void(this.isEditActive=!1);delete this.user.id,delete this.user.role;var t=this.user;t.resource_names=t.resource_names.split(" "),this.isEditActive=!1,this.isWaiting=!0,this.$http.patch("users/"+t.username,t).then((function(s){for(var a=e.users,n=0;n<a.length;n++)if(a[n].username==t.username){a[n]=t;break}e.users=Object(N["a"])(a),e.isWaiting=!1}),(function(s){e.$buefy.toast.open({message:"Updating the "+t.username+" user failed with "+s.status+" status.",type:"is-danger",duration:4e3}),e.isWaiting=!1})),this.resetLocalUser()},deleteUser:function(e){var t=this;e!==this.$store.getters.username?this.$buefy.dialog.confirm({title:"Delete the User",message:"This will DELETE the "+e+" user. Are you sure you want to do this?",cancelText:"Cancel",confirmText:"Delete",type:"is-danger",hasIcon:!0,onConfirm:function(){t.isWaiting=!0,t.$http.delete("users/"+e).then((function(s){for(var a=t.users,n=0;n<a.length;n++)if(a[n].username==e){a.splice(n,1);break}t.users=Object(N["a"])(a),t.$buefy.toast.open({message:"The user "+e+" was deleted.",type:"is-success"}),t.isWaiting=!1}),(function(s){t.$buefy.toast.open({message:"Deleting the user "+e+" failed with "+s.status+" status.",type:"is-danger",duration:4e3})}))}}):this.$buefy.toast.open({message:"You cannot delete the user you are currently logged in as.",type:"is-danger",duration:4e3})},resetLocalUser:function(){this.user={}}},data:function(){return{table:{striped:!0,isPaginated:!0,isPaginationSimple:!0,paginationSize:"is-small",defaultSortDirection:"asc",currentPage:1,perPage:10},roles:["Global Admin","Experiment Admin","Experiment User","Experiment Viewer","VM Viewer"],users:[],user:{},userExists:!1,isCreateActive:!1,isEditActive:!1,isWaiting:!0}}},ae=se,ne=Object(h["a"])(ae,ee,te,!1,null,null,null),ie=ne.exports,re=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"content"},[e.disabled?[e._m(0)]:0==e.logs.length?[e._m(1)]:[s("hr"),s("b-field",{attrs:{position:"is-right"}},[s("b-autocomplete",{attrs:{placeholder:"Search a log",icon:"search",data:e.filteredData},on:{select:function(t){return e.filtered=t}},model:{value:e.searchLog,callback:function(t){e.searchLog=t},expression:"searchLog"}},[s("template",{slot:"empty"},[e._v("\n          No results found\n        ")])],2),s("p",{staticClass:"control"},[s("button",{staticClass:"button",staticStyle:{color:"#686868"},on:{click:function(t){e.searchLog=""}}},[s("b-icon",{attrs:{icon:"window-close"}})],1)])],1),s("div",[s("b-table",{attrs:{data:e.filteredLogs,paginated:e.table.isPaginated&&e.paginationNeeded,"per-page":e.table.perPage,"current-page":e.table.currentPage,"pagination-simple":e.table.isPaginationSimple,"pagination-size":e.table.paginationSize,"default-sort-direction":e.table.defaultSortDirection,"default-sort":"timestamp"},on:{"update:currentPage":function(t){return e.$set(e.table,"currentPage",t)},"update:current-page":function(t){return e.$set(e.table,"currentPage",t)}},scopedSlots:e._u([{key:"default",fn:function(t){return[s("b-table-column",{attrs:{field:"timestamp",label:"Timestamp",width:"200",sortable:""}},[e._v("\n            "+e._s(t.row.timestamp)+"\n          ")]),s("b-table-column",{attrs:{field:"source",label:"Source",sortable:"",centered:""}},[e._v("\n            "+e._s(t.row.source)+"\n          ")]),s("b-table-column",{attrs:{field:"level",label:"Level",centered:""}},[s("span",{staticClass:"tag",class:e.decorator(t.row.level)},[e._v("\n              "+e._s(t.row.level)+"\n            ")])]),s("b-table-column",{attrs:{field:"log",label:"Log"}},[e._v("\n            "+e._s(t.row.log)+"\n          ")])]}}])}),e.paginationNeeded?s("b-field",{attrs:{grouped:"",position:"is-right"}},[s("div",{staticClass:"control is-flex"},[s("b-switch",{attrs:{size:"is-small",type:"is-light"},model:{value:e.table.isPaginated,callback:function(t){e.$set(e.table,"isPaginated",t)},expression:"table.isPaginated"}},[e._v("Pagenate")])],1)]):e._e()],1)]],2)},oe=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("section",{staticClass:"hero is-light is-bold is-large"},[s("div",{staticClass:"hero-body"},[s("div",{staticClass:"container",staticStyle:{"text-align":"center"}},[s("h1",{staticClass:"title"},[e._v("\n            Nothing to see here... logs have been disabled server-side.\n          ")])])])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("section",{staticClass:"hero is-light is-bold is-large"},[s("div",{staticClass:"hero-body"},[s("div",{staticClass:"container",staticStyle:{"text-align":"center"}},[s("h1",{staticClass:"title"},[e._v("\n            There are no logs!\n          ")])])])])}],le={beforeDestroy:function(){this.$options.sockets.onmessage=null,this.logs=[]},created:function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(){var t,s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$http.get("logs");case 3:return t=e.sent,e.next=6,t.json();case 6:s=e.sent,s&&(a=this.logs).push.apply(a,Object(N["a"])(s.logs)),this.$options.sockets.onmessage=this.handler,e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),501==e.t0.status?this.disabled=!0:this.$buefy.toast.open({message:"Getting the past hour of logs failed with "+e.t0.status+" status.",type:"is-danger",duration:4e3});case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));function t(){return e.apply(this,arguments)}return t}(),computed:{filteredLogs:function(){for(var e=this.logs,t={sources:[],levels:[]},s=this.searchLog.split(" "),a=s.length-1;a>=0;a--){var n=s[a];if(n.includes(":")){var i=n.split(":");switch(i[0].toLowerCase()){case"source":t["sources"]=t["sources"].concat(i[1].split(",").map((function(e){return e.toLowerCase()})));break;case"level":t["levels"]=t["levels"].concat(i[1].split(",").map((function(e){return e.toLowerCase()})));break}s.splice(a,1)}}var r=new RegExp(s.join(" "),"i"),o=[];for(var l in e){var u=e[l];(0==t["sources"].length||t["sources"].includes(u.source.toLowerCase()))&&(0==t["levels"].length||t["levels"].includes(u.level.toLowerCase()))&&u.log.match(r)&&o.push(u)}return o},filteredData:function(){var e=this,t=this.logs.map((function(e){return e.log}));return t.filter((function(t){return t.toString().toLowerCase().indexOf(e.searchLog.toLowerCase())>=0}))},paginationNeeded:function(){return!(this.logs.length<=10)}},methods:{handler:function(e){var t=this;console.log(this.logs.length),e.data.split(/\r?\n/).forEach((function(e){var s=JSON.parse(e);t.handle(s)}))},handle:function(e){"log"==e.resource.type&&this.logs.push(e.result)},decorator:function(e){return"ERROR"==e||"FATAL"==e?"is-danger":"WARN"==e?"is-warning":"INFO"==e?"is-info":"is-primary"}},data:function(){return{table:{striped:!0,isPaginated:!0,isPaginationSimple:!0,paginationSize:"is-small",defaultSortDirection:"desc",currentPage:1,perPage:10},disabled:!1,logs:[],searchLog:""}}},ue=le,ce=(s("5c39"),Object(h["a"])(ue,re,oe,!1,null,"4f2847a0",null)),de=ce.exports,pe=s("31c2"),me=s("2f62");a["a"].use(me["a"]);var he=new me["a"].Store({state:{username:null,token:null,role:null,auth:null},mutations:{LOGIN:function(e,t){var s=t.user,a=t.remember;e.username=s.username,e.token=s.token,e.role=s.role,e.auth=!0,a&&(localStorage.setItem("user",e.username),localStorage.setItem("token",e.token),localStorage.setItem("role",e.role),localStorage.setItem("auth",e.auth)),"VM Viewer"===e.role?ge.replace("/vmtiles"):ge.replace("/experiments")},LOGOUT:function(e){e.username=null,e.token=null,e.role=null,e.auth=!1,e.logs=[],localStorage.getItem("auth")&&(localStorage.removeItem("user"),localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.setItem("auth",e.auth)),ge.replace("/signin")}},getters:{username:function(e){return e.username},token:function(e){return e.token},role:function(e){return e.role},auth:function(e){return e.auth}}});a["a"].use(M["a"]);var fe=new M["a"]({mode:"history",base:"/",routes:[{path:"/",name:"home",redirect:"/experiments"},{path:"/experiments",name:"experiments",component:j},{path:"/experiment/:id",name:"experiment",component:G},{path:"/vmtiles",name:"vmtiles",component:pe["default"]},{path:"/hosts",name:"hosts",component:H},{path:"/users",name:"users",component:ie},{path:"/log",name:"log",component:de},{path:"/signin",name:"signin",component:X},{path:"*",redirect:"/signin"}]});fe.beforeEach((function(e,t,s){if("disabled"!==Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_AUTH){var a=["/signup","/signin"];a.includes(e.path)||he.state.auth?s():s("/signin")}else s()}));var ge=fe,be=s("c074"),ve=s("ecee"),_e=s("ad3d");ve["c"].add(be["a"]),ve["c"].add(be["b"]),a["a"].component("font-awesome-icon",_e["a"]),a["a"].config.productionTip=!1,a["a"].use(i["a"],{defaultIconPack:"fa"}),a["a"].use(n["a"]),a["a"].use(o.a,"//"+location.host,{connectManually:!0,reconnection:!0}),a["a"].filter("lowercase",(function(e){return null==e?e:e.toLowerCase()})),a["a"].filter("stringify",(function(e){return null==e||0==e.length?"none":e.join(", ")})),a["a"].filter("ram",(function(e){if(0==e)return"0 Byte";var t=["MB","GB"],s=parseInt(Math.floor(Math.log(e)/Math.log(1024))),a=Math.round(e/Math.pow(1024,s),2)+" "+t[s];return a})),a["a"].filter("uptime",(function(e){var t=null;if(null==e)return e;var s=parseInt(e,10),a=Math.floor(s/86400);s-=3600*a*24;var n=Math.floor(s/3600);s-=3600*n;var i=Math.floor(s/60);return s-=60*i,t=a>=1?a+" days, "+("0"+n).slice(-2)+":"+("0"+i).slice(-2)+":"+("0"+s).slice(-2):("0"+n).slice(-2)+":"+("0"+i).slice(-2)+":"+("0"+s).slice(-2),t})),a["a"].http.options.root="/api/v1/",a["a"].http.interceptors.push((function(e){return he.state.token&&e.headers.set("Authorization","bearer "+he.state.token),function(e){401===e.status&&(he.commit("LOGOUT"),ge.replace("/signin"))}})),new a["a"]({router:ge,store:he,render:function(e){return e(E)}}).$mount("#app")},"5c0b":function(e,t,s){"use strict";var a=s("e332"),n=s.n(a);n.a},"5c39":function(e,t,s){"use strict";var a=s("3d06"),n=s.n(a);n.a},"5ea9":function(e,t,s){"use strict";var a=s("f7e5"),n=s.n(a);n.a},"77a4":function(e,t,s){"use strict";var a=s("caa3"),n=s.n(a);n.a},8174:function(e,t,s){"use strict";var a=s("ac4c"),n=s.n(a);n.a},ac4c:function(e,t,s){},caa3:function(e,t,s){},e332:function(e,t,s){},f7e5:function(e,t,s){}});
//# sourceMappingURL=app.7ff1dd35.js.map